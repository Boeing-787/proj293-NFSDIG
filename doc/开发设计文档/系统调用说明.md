# 系统调用过滤功能使用示例

## 功能概述

现在 `syscount` 工具支持跟踪指定的系统调用或系统调用集合：

### 2. 跟踪多个系统调用

```bash
# 跟踪文件操作相关的系统调用
./syscount -S "read,write,open,close"

# 跟踪网络相关的系统调用
./syscount -S "socket,connect,accept,send,recv"

# 跟踪进程相关的系统调用
./syscount -S "fork,exec,exit,wait"
```

### 3. 结合其他选项

```bash
# 跟踪特定进程的系统调用
./syscount -p $(pidof bash) -S "read,write"

# 跟踪系统调用并显示延迟
./syscount -L -S "read,write,open"

# 只跟踪失败的特定系统调用
./syscount -x -S "open,connect"

# 按进程分组显示特定系统调用
./syscount -P -S "read,write"
```

### 4. 查看可用的系统调用

```bash
# 列出所有可用的系统调用
./syscount -l
```

## 注意事项

1. 系统调用名称不区分大小写
2. 支持使用数字ID或系统调用名称
3. 多个系统调用用逗号分隔，支持空格
4. 最多支持64个系统调用

## 输出示例

当使用 `-S` 选项时，程序会显示已添加的系统调用：

```
Added 3 syscalls to filter: read(0), write(1), open(2)
Tracing syscalls, printing top 10... Ctrl+C to quit.
[12:34:56]
SYSCALL               COUNT
read                    1234
write                    567
open                     89
```

## 常见系统调用ID

| 系统调用 | ID | 描述 |
|---------|----|------|
| read | 0 | 读取文件 |
| write | 1 | 写入文件 |
| open | 2 | 打开文件 |
| close | 3 | 关闭文件 |
| stat | 4 | 获取文件状态 |
| fstat | 5 | 获取文件描述符状态 |
| lstat | 6 | 获取链接状态 |
| poll | 7 | 等待文件描述符事件 |
| lseek | 8 | 文件定位 |
| mmap | 9 | 内存映射 |
| mprotect | 10 | 内存保护 |
| munmap | 11 | 取消内存映射 |
| brk | 12 | 改变数据段大小 |
| rt_sigaction | 13 | 信号处理 |
| rt_sigprocmask | 14 | 信号掩码 |
| rt_sigreturn | 15 | 信号返回 |
| ioctl | 16 | 设备控制 |
| pread64 | 17 | 从指定位置读取 |
| pwrite64 | 18 | 向指定位置写入 |
| readv | 19 | 向量读取 |
| writev | 20 | 向量写入 |
| access | 21 | 检查文件访问权限 |
| pipe | 22 | 创建管道 |
| select | 23 | 多路复用 |
| sched_yield | 24 | 让出CPU |
| mremap | 25 | 重新映射内存 |
| msync | 26 | 同步内存映射 |
| mincore | 27 | 检查内存页 |
| madvise | 28 | 内存建议 |
| shmget | 29 | 获取共享内存 |
| shmat | 30 | 附加共享内存 |
| shmctl | 31 | 共享内存控制 |
| dup | 32 | 复制文件描述符 |
| dup2 | 33 | 复制文件描述符到指定编号 |
| pause | 34 | 暂停进程 |
| nanosleep | 35 | 纳秒级睡眠 |
| getitimer | 36 | 获取定时器 |
| alarm | 37 | 设置闹钟 |
| setitimer | 38 | 设置定时器 |
| getpid | 39 | 获取进程ID |
| sendfile | 40 | 文件传输 |
| socket | 41 | 创建套接字 |
| connect | 42 | 连接套接字 |
| accept | 43 | 接受连接 |
| sendto | 44 | 发送数据 |
| recvfrom | 45 | 接收数据 |
| sendmsg | 46 | 发送消息 |
| recvmsg | 47 | 接收消息 |
| shutdown | 48 | 关闭套接字 |
| bind | 49 | 绑定套接字 |
| listen | 50 | 监听连接 |
| getsockname | 51 | 获取套接字名称 |
| getpeername | 52 | 获取对端名称 |
| socketpair | 53 | 创建套接字对 |
| setsockopt | 54 | 设置套接字选项 |
| getsockopt | 55 | 获取套接字选项 |
| clone | 56 | 创建进程 |
| fork | 57 | 创建子进程 |
| vfork | 58 | 创建子进程(虚拟) |
| execve | 59 | 执行程序 |
| exit | 60 | 退出进程 |
| wait4 | 61 | 等待子进程 |
| kill | 62 | 发送信号 |
| uname | 63 | 获取系统信息 |
| semget | 64 | 获取信号量 |
| semop | 65 | 信号量操作 |
| semctl | 66 | 信号量控制 |
| shmdt | 67 | 分离共享内存 |
| msgget | 68 | 获取消息队列 |
| msgsnd | 69 | 发送消息 |
| msgrcv | 70 | 接收消息 |
| msgctl | 71 | 消息队列控制 |
| fcntl | 72 | 文件控制 |
| flock | 73 | 文件锁定 |
| fsync | 74 | 同步文件 |
| fdatasync | 75 | 同步文件数据 |
| truncate | 76 | 截断文件 |
| ftruncate | 77 | 截断文件描述符 |
| getdents | 78 | 获取目录项 |
| getcwd | 79 | 获取当前工作目录 |
| chdir | 80 | 改变目录 |
| fchdir | 81 | 改变目录(通过文件描述符) |
| rename | 82 | 重命名文件 |
| mkdir | 83 | 创建目录 |
| rmdir | 84 | 删除目录 |
| creat | 85 | 创建文件 |
| link | 86 | 创建硬链接 |
| unlink | 87 | 删除文件 |
| symlink | 88 | 创建符号链接 |
| readlink | 89 | 读取符号链接 |
| chmod | 90 | 改变文件权限 |
| fchmod | 91 | 改变文件权限(通过文件描述符) |
| chown | 92 | 改变文件所有者 |
| fchown | 93 | 改变文件所有者(通过文件描述符) |
| lchown | 94 | 改变链接所有者 |
| umask | 95 | 设置文件掩码 |
| gettimeofday | 96 | 获取时间 |
| getrlimit | 97 | 获取资源限制 |
| getrusage | 98 | 获取资源使用情况 |
| sysinfo | 99 | 获取系统信息 |
| times | 100 | 获取进程时间 |
| ptrace | 101 | 进程跟踪 |
| getuid | 102 | 获取用户ID |
| syslog | 103 | 系统日志 |
| getgid | 104 | 获取组ID |
| setuid | 105 | 设置用户ID |
| setgid | 106 | 设置组ID |
| geteuid | 107 | 获取有效用户ID |
| getegid | 108 | 获取有效组ID |
| setpgid | 109 | 设置进程组 |
| getppid | 110 | 获取父进程ID |
| getpgrp | 111 | 获取进程组 |
| setsid | 112 | 设置会话ID |
| setreuid | 113 | 设置真实和有效用户ID |
| setregid | 114 | 设置真实和有效组ID |
| getgroups | 115 | 获取附加组 |
| setgroups | 116 | 设置附加组 |
| setresuid | 117 | 设置真实、有效和保存用户ID |
| getresuid | 118 | 获取真实、有效和保存用户ID |
| setresgid | 119 | 设置真实、有效和保存组ID |
| getresgid | 120 | 获取真实、有效和保存组ID |
| getpgid | 121 | 获取进程组ID |
| setfsuid | 122 | 设置文件系统用户ID |
| setfsgid | 123 | 设置文件系统组ID |
| getsid | 124 | 获取会话ID |
| capget | 125 | 获取能力 |
| capset | 126 | 设置能力 |
| rt_sigpending | 127 | 获取待处理信号 |
| rt_sigtimedwait | 128 | 等待信号 |
| rt_sigqueueinfo | 129 | 排队信号 |
| rt_sigsuspend | 130 | 挂起等待信号 |
| sigaltstack | 131 | 设置信号栈 |
| utime | 132 | 设置文件访问和修改时间 |
| mknod | 133 | 创建特殊文件 |
| uselib | 134 | 加载共享库 |
| personality | 135 | 设置进程个性 |
| ugetrlimit | 136 | 获取资源限制 |
| statfs | 137 | 获取文件系统状态 |
| fstatfs | 138 | 获取文件系统状态(通过文件描述符) |
| sysfs | 139 | 获取文件系统类型信息 |
| getpriority | 140 | 获取进程优先级 |
| setpriority | 141 | 设置进程优先级 |
| sched_setparam | 142 | 设置调度参数 |
| sched_getparam | 143 | 获取调度参数 |
| sched_setscheduler | 144 | 设置调度策略 |
| sched_getscheduler | 145 | 获取调度策略 |
| sched_get_priority_max | 146 | 获取最大优先级 |
| sched_get_priority_min | 147 | 获取最小优先级 |
| sched_rr_get_interval | 148 | 获取时间片 |
| mlock | 149 | 锁定内存页 |
| munlock | 150 | 解锁内存页 |
| mlockall | 151 | 锁定所有内存页 |
| munlockall | 152 | 解锁所有内存页 |
| vhangup | 153 | 虚拟挂断 |
| modify_ldt | 154 | 修改本地描述符表 |
| pivot_root | 155 | 改变根文件系统 |
| _sysctl | 156 | 系统控制 |
| prctl | 157 | 进程控制 |
| arch_prctl | 158 | 架构特定进程控制 |
| adjtimex | 159 | 调整系统时钟 |
| setrlimit | 160 | 设置资源限制 |
| chroot | 161 | 改变根目录 |
| sync | 162 | 同步文件系统 |
| acct | 163 | 切换进程记账 |
| settimeofday | 164 | 设置时间 |
| mount | 165 | 挂载文件系统 |
| umount2 | 166 | 卸载文件系统 |
| swapon | 167 | 启用交换分区 |
| swapoff | 168 | 禁用交换分区 |
| reboot | 169 | 重启系统 |
| sethostname | 170 | 设置主机名 |
| setdomainname | 171 | 设置域名 |
| iopl | 172 | I/O权限级别 |
| ioperm | 173 | I/O权限 |
| create_module | 174 | 创建内核模块 |
| init_module | 175 | 初始化内核模块 |
| delete_module | 176 | 删除内核模块 |
| get_kernel_syms | 177 | 获取内核符号 |
| query_module | 178 | 查询内核模块 |
| quotactl | 179 | 配额控制 |
| nfsservctl | 180 | NFS服务器控制 |
| getpmsg | 181 | 获取控制消息 |
| putpmsg | 182 | 发送控制消息 |
| afs_syscall | 183 | AFS系统调用 |
| tuxcall | 184 | TUX系统调用 |
| security | 185 | 安全系统调用 |
| gettid | 186 | 获取线程ID |
| readahead | 187 | 预读文件 |
| setxattr | 188 | 设置扩展属性 |
| lsetxattr | 189 | 设置扩展属性(符号链接) |
| fsetxattr | 190 | 设置扩展属性(文件描述符) |
| getxattr | 191 | 获取扩展属性 |
| lgetxattr | 192 | 获取扩展属性(符号链接) |
| fgetxattr | 193 | 获取扩展属性(文件描述符) |
| listxattr | 194 | 列出扩展属性 |
| llistxattr | 195 | 列出扩展属性(符号链接) |
| flistxattr | 196 | 列出扩展属性(文件描述符) |
| removexattr | 197 | 删除扩展属性 |
| lremovexattr | 198 | 删除扩展属性(符号链接) |
| fremovexattr | 199 | 删除扩展属性(文件描述符) |
| tkill | 200 | 发送信号到线程 |
| time | 201 | 获取时间 |
| futex | 202 | 快速用户空间锁定 |
| sched_setaffinity | 203 | 设置CPU亲和性 |
| sched_getaffinity | 204 | 获取CPU亲和性 |
| set_thread_area | 205 | 设置线程本地存储 |
| io_setup | 206 | 设置异步I/O |
| io_destroy | 207 | 销毁异步I/O |
| io_getevents | 208 | 获取异步I/O事件 |
| io_submit | 209 | 提交异步I/O请求 |
| io_cancel | 210 | 取消异步I/O请求 |
| get_thread_area | 211 | 获取线程本地存储 |
| lookup_dcookie | 212 | 查找目录cookie |
| epoll_create | 213 | 创建epoll实例 |
| epoll_ctl_old | 214 | 控制epoll(旧版本) |
| epoll_wait_old | 215 | 等待epoll事件(旧版本) |
| remap_file_pages | 216 | 重新映射文件页 |
| getdents64 | 217 | 获取目录项(64位) |
| set_tid_address | 218 | 设置线程ID地址 |
| restart_syscall | 219 | 重启系统调用 |
| semtimedop | 220 | 信号量操作(带超时) |
| fadvise64 | 221 | 文件访问建议 |
| timer_create | 222 | 创建定时器 |
| timer_settime | 223 | 设置定时器 |
| timer_gettime | 224 | 获取定时器时间 |
| timer_getoverrun | 225 | 获取定时器超限 |
| timer_delete | 226 | 删除定时器 |
| clock_settime | 227 | 设置时钟时间 |
| clock_gettime | 228 | 获取时钟时间 |
| clock_getres | 229 | 获取时钟分辨率 |
| clock_nanosleep | 230 | 时钟纳秒睡眠 |
| exit_group | 231 | 退出进程组 |
| epoll_wait | 232 | 等待epoll事件 |
| epoll_ctl | 233 | 控制epoll |
| tgkill | 234 | 发送信号到线程组 |
| utimes | 235 | 设置文件访问和修改时间 |
| vserver | 236 | 虚拟服务器 |
| mbind | 237 | 内存绑定 |
| set_mempolicy | 238 | 设置内存策略 |
| get_mempolicy | 239 | 获取内存策略 |
| mq_open | 240 | 打开消息队列 |
| mq_unlink | 241 | 删除消息队列 |
| mq_timedsend | 242 | 发送消息(带超时) |
| mq_timedreceive | 243 | 接收消息(带超时) |
| mq_notify | 244 | 消息队列通知 |
| mq_getsetattr | 245 | 获取/设置消息队列属性 |
| kexec_load | 246 | 加载内核 |
| waitid | 247 | 等待子进程 |
| add_key | 248 | 添加密钥 |
| request_key | 249 | 请求密钥 |
| keyctl | 250 | 密钥控制 |
| ioprio_set | 251 | 设置I/O优先级 |
| ioprio_get | 252 | 获取I/O优先级 |
| inotify_init | 253 | 初始化inotify |
| inotify_add_watch | 254 | 添加inotify监视 |
| inotify_rm_watch | 255 | 删除inotify监视 |
| migrate_pages | 256 | 迁移内存页 |
| openat | 257 | 打开文件(相对路径) |
| mkdirat | 258 | 创建目录(相对路径) |
| mknodat | 259 | 创建特殊文件(相对路径) |
| fchownat | 260 | 改变文件所有者(相对路径) |
| futimesat | 261 | 设置文件时间(相对路径) |
| newfstatat | 262 | 获取文件状态(相对路径) |
| unlinkat | 263 | 删除文件(相对路径) |
| renameat | 264 | 重命名文件(相对路径) |
| linkat | 265 | 创建硬链接(相对路径) |
| symlinkat | 266 | 创建符号链接(相对路径) |
| readlinkat | 267 | 读取符号链接(相对路径) |
| fchmodat | 268 | 改变文件权限(相对路径) |
| faccessat | 269 | 检查文件访问权限(相对路径) |
| pselect6 | 270 | 多路复用(带超时) |
| ppoll | 271 | 多路复用(带超时) |
| unshare | 272 | 取消共享命名空间 |
| set_robust_list | 273 | 设置健壮futex列表 |
| get_robust_list | 274 | 获取健壮futex列表 |
| splice | 275 | 零拷贝数据传输 |
| tee | 276 | 复制管道数据 |
| sync_file_range | 277 | 同步文件范围 |
| vmsplice | 278 | 内存到管道传输 |
| move_pages | 279 | 移动内存页 |
| utimensat | 280 | 设置文件时间(相对路径) |
| epoll_pwait | 281 | 等待epoll事件(带信号掩码) |
| signalfd | 282 | 信号文件描述符 |
| timerfd_create | 283 | 创建定时器文件描述符 |
| eventfd | 284 | 事件文件描述符 |
| fallocate | 285 | 预分配文件空间 |
| timerfd_settime | 286 | 设置定时器文件描述符 |
| timerfd_gettime | 287 | 获取定时器文件描述符 |
| accept4 | 288 | 接受连接(带标志) |
| signalfd4 | 289 | 信号文件描述符(带标志) |
| eventfd2 | 290 | 事件文件描述符(带标志) |
| epoll_create1 | 291 | 创建epoll实例(带标志) |
| dup3 | 292 | 复制文件描述符(带标志) |
| pipe2 | 293 | 创建管道(带标志) |
| inotify_init1 | 294 | 初始化inotify(带标志) |
| preadv | 295 | 向量读取(带偏移) |
| pwritev | 296 | 向量写入(带偏移) |
| rt_tgsigqueueinfo | 297 | 排队信号到线程组 |
| perf_event_open | 298 | 打开性能事件 |
| recvmmsg | 299 | 接收多个消息 |
| fanotify_init | 300 | 初始化fanotify |
| fanotify_mark | 301 | 标记fanotify |
| prlimit64 | 302 | 设置/获取资源限制(64位) |
| name_to_handle_at | 303 | 名称到句柄 |
| open_by_handle_at | 304 | 通过句柄打开 |
| clock_adjtime | 305 | 调整时钟 |
| syncfs | 306 | 同步文件系统 |
| sendmmsg | 307 | 发送多个消息 |
| setns | 308 | 设置命名空间 |
| getcpu | 309 | 获取CPU和NUMA节点 |
| process_vm_readv | 310 | 进程间向量读取 |
| process_vm_writev | 311 | 进程间向量写入 |
| kcmp | 312 | 内核比较 |
| finit_module | 313 | 从文件初始化内核模块 |
| sched_setattr | 314 | 设置调度属性 |
| sched_getattr | 315 | 获取调度属性 |
| renameat2 | 316 | 重命名文件(带标志) |
| seccomp | 317 | 安全计算 |
| getrandom | 318 | 获取随机数 |
| memfd_create | 319 | 创建内存文件 |
| kexec_file_load | 320 | 从文件加载内核 |
| bpf | 321 | BPF系统调用 |
| execveat | 322 | 执行程序(相对路径) |
| userfaultfd | 323 | 用户页错误文件描述符 |
| membarrier | 324 | 内存屏障 |
| mlock2 | 325 | 锁定内存页(带标志) |
| copy_file_range | 326 | 复制文件范围 |
| preadv2 | 327 | 向量读取(带标志) |
| pwritev2 | 328 | 向量写入(带标志) |
| pkey_mprotect | 329 | 内存保护键 |
| pkey_alloc | 330 | 分配内存保护键 |
| pkey_free | 331 | 释放内存保护键 |
| statx | 332 | 获取文件状态(扩展) |
| io_pgetevents | 333 | 获取异步I/O事件(带超时) |
| rseq | 334 | 重启序列 |
| pidfd_send_signal | 335 | 通过文件描述符发送信号 |
| io_uring_setup | 336 | 设置io_uring |
| io_uring_enter | 337 | 进入io_uring |
| io_uring_register | 338 | 注册io_uring |
| open_tree | 339 | 打开文件树 |
| move_mount | 340 | 移动挂载点 |
| fsopen | 341 | 打开文件系统 |
| fsconfig | 342 | 配置文件系统 |
| fsmount | 343 | 挂载文件系统 |
| fspick | 344 | 选择文件系统 |
| pidfd_open | 345 | 打开进程文件描述符 |
| clone3 | 346 | 创建进程(扩展) |
| close_range | 347 | 关闭文件描述符范围 |
| openat2 | 348 | 打开文件(扩展) |
| pidfd_getfd | 349 | 获取文件描述符 |
| faccessat2 | 350 | 检查文件访问权限(扩展) |
| process_madvise | 351 | 进程内存建议 |
| epoll_pwait2 | 352 | 等待epoll事件(扩展) |
| mount_setattr | 353 | 设置挂载属性 |
| quotactl_fd | 354 | 配额控制(文件描述符) |
| landlock_create_ruleset | 355 | 创建Landlock规则集 |
| landlock_add_rule | 356 | 添加Landlock规则 |
| landlock_restrict_self | 357 | 限制自身 |
| memfd_secret | 358 | 创建秘密内存文件 |
| process_mrelease | 359 | 进程内存释放 |
| futex_waitv | 360 | 等待多个futex |
| set_mempolicy_home_node | 361 | 设置内存策略主节点 |
| cachestat | 362 | 缓存状态 |
| fchmodat2 | 363 | 改变文件权限(扩展) |
| map_shadow_stack | 364 | 映射影子栈 |
| futex_wake | 365 | 唤醒futex |
| futex_wait | 366 | 等待futex |
| futex_requeue | 367 | 重新排队futex | 