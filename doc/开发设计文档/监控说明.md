监控 = 指标 + 日志 + 跟踪

# 指标
由于nfs的性能表现与系统的相关资源与性能息息相关，这里我们把指标分为nfs的指标和相关的系统指标。出于长时间监控的开销考虑，nfs的指标我们使用nfsstat，和nfsiostat命令来获取，系统指标我们使用内核自带的统计工具来获取。由于这些命令的输出比较多，我们只关注几个关键的指标。
### nfs
nfsstat: 各种nfs操作的计数, rpc状态计数
nfsiostat: nfs读写延迟，吞吐量和IOPS，错误数(默认)
nfsiostat: nfs属性缓存操作的延迟，吞吐量和IOPS，错误数（-a）
nfsiostat: nfs目录操作的延迟，吞吐量和IOPS，错误数（-d）

### CPU
uptime: 平均负载
mpstat: "mpstat -P ALL 1"  各个CPU使用率

### 内存
free: "free -m"  内存使用情况
vmstat: "vmstat 1"  内存使用情况(更全面)

### 文件系统
df: "df -h | grep nfs"  nfs文件系统使用情况,重点关注使用率

### 网络
ss: "ss --tcp | grep nfs" 监控nfs套接字，重点关注Rev-Q和Send-Q
nicstat: "nicstat -i eth0"  eth0网络接口使用情况,在我们的测试中应该使用lo接口

### 磁盘（这个指标只在nfs服务端有效，取决于nfs导出目录所在文件系统具体在哪个磁盘读写）
iostat： 

# 日志
sudo dmesg | grep nfs

# 跟踪
1. nfsdig(完善中)： 读写延迟的分解，文件系统函数级自定义跟踪,nfs操作统计
2. nfstrace： 基于nfs操作的跟踪——“sudo nfstrace -i lo -T -Z lll”
3. pwru： 网络包跟踪